{"ast":null,"code":"var _jsxFileName = \"F:\\\\\\u540C\\u6D4E\\u5B9E\\u4E60\\\\cutting\\\\src\\\\containers\\\\ShowClothes\\\\ClothBox.js\",\n  _s = $RefreshSig$();\nimport React, { forwardRef, useCallback, useEffect, useImperativeHandle, useRef } from 'react';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst ClothBox = /*#__PURE__*/_s( /*#__PURE__*/forwardRef(_c = _s(({\n  sketchDataURL,\n  patternDataURL,\n  selected,\n  spacing\n}, ref) => {\n  _s();\n  const canvasRef = useRef(null);\n  const saveCanvasAsImage = useCallback(() => {\n    const canvas = canvasRef.current;\n    if (canvas) {\n      const imageData = patternDataURL;\n      const link = document.createElement('a');\n      link.href = imageData;\n      link.download = 'canvas-image.png';\n      document.body.appendChild(link);\n      link.click();\n      document.body.removeChild(link);\n    }\n  }, [patternDataURL]);\n\n  // ��������\n  const debounce = useCallback((func, wait) => {\n    let timeout;\n    return (...args) => {\n      clearTimeout(timeout);\n      timeout = setTimeout(() => {\n        func.apply(this, args);\n      }, wait);\n    };\n  }, []);\n  useImperativeHandle(ref, () => ({\n    saveCanvasAsImage\n  }));\n  useEffect(() => {\n    const canvas = canvasRef.current;\n    const ctx = canvas.getContext('2d');\n    const clothImage = new Image();\n    const patternImage = new Image();\n    clothImage.onload = () => {\n      const {\n        width,\n        height\n      } = clothImage;\n      canvas.width = width;\n      canvas.height = height;\n      canvas.style.width = 'auto'; // ����canvas����Ϊ������50%���߶�����Ӧ���ֱ���\n      canvas.style.height = '100%';\n      canvas.style.objectFit = 'contain'; // ȷ��ͼ�񲻻ᱻ����\n      canvas.style.display = 'block'; // ʹcanvas���������о���\n      canvas.style.margin = 'auto';\n      ctx.drawImage(clothImage, 0, 0, canvas.width, canvas.height);\n      patternImage.onload = () => {\n        console.log(1);\n        const tempCanvas = document.createElement('canvas');\n        const tempCtx = tempCanvas.getContext('2d');\n        tempCanvas.width = canvas.width;\n        tempCanvas.height = canvas.height;\n        tempCtx.drawImage(patternImage, 0, 0, tempCanvas.width, tempCanvas.height);\n        tempCtx.globalCompositeOperation = 'destination-in';\n        tempCtx.drawImage(clothImage, 0, 0, tempCanvas.width, tempCanvas.height);\n        ctx.globalCompositeOperation = 'multiply';\n        ctx.drawImage(tempCanvas, 0, 0);\n        ctx.globalCompositeOperation = 'source-over';\n      };\n      patternImage.src = patternDataURL;\n    };\n    clothImage.src = 'cloth-removebg-preview.png'; // ���滻Ϊʵ�ʵ��·�ͼ��·��\n  }, [debounce, patternDataURL, spacing, sketchDataURL]);\n  return /*#__PURE__*/_jsxDEV(\"canvas\", {\n    ref: canvasRef\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 76,\n    columnNumber: 10\n  }, this);\n}, \"9TAvmyMsYDCgXVi3HQlhJkz4Aqo=\")), \"9TAvmyMsYDCgXVi3HQlhJkz4Aqo=\");\n_c2 = ClothBox;\nexport default ClothBox;\nvar _c, _c2;\n$RefreshReg$(_c, \"ClothBox$forwardRef\");\n$RefreshReg$(_c2, \"ClothBox\");","map":{"version":3,"names":["React","forwardRef","useCallback","useEffect","useImperativeHandle","useRef","jsxDEV","_jsxDEV","ClothBox","_s","_c","sketchDataURL","patternDataURL","selected","spacing","ref","canvasRef","saveCanvasAsImage","canvas","current","imageData","link","document","createElement","href","download","body","appendChild","click","removeChild","debounce","func","wait","timeout","args","clearTimeout","setTimeout","apply","ctx","getContext","clothImage","Image","patternImage","onload","width","height","style","objectFit","display","margin","drawImage","console","log","tempCanvas","tempCtx","globalCompositeOperation","src","fileName","_jsxFileName","lineNumber","columnNumber","_c2","$RefreshReg$"],"sources":["F:/同济实习/cutting/src/containers/ShowClothes/ClothBox.js"],"sourcesContent":["import React, {forwardRef, useCallback, useEffect, useImperativeHandle, useRef} from 'react';\r\n\r\nconst ClothBox = forwardRef(({ sketchDataURL, patternDataURL,selected,spacing }, ref) => {\r\n  const canvasRef = useRef(null);\r\n\r\n  const saveCanvasAsImage = useCallback(() => {\r\n    const canvas = canvasRef.current;\r\n    if (canvas) {\r\n      const imageData = patternDataURL;\r\n      const link = document.createElement('a');\r\n      link.href = imageData;\r\n      link.download = 'canvas-image.png';\r\n      document.body.appendChild(link);\r\n      link.click();\r\n      document.body.removeChild(link);\r\n    }\r\n  }, [patternDataURL]);\r\n\r\n  // ��������\r\n  const debounce = useCallback((func, wait) => {\r\n    let timeout;\r\n    return (...args) => {\r\n      clearTimeout(timeout);\r\n      timeout = setTimeout(() => {\r\n        func.apply(this, args);\r\n      }, wait);\r\n    };\r\n  }, []);\r\n\r\n  useImperativeHandle(ref, () => ({\r\n    saveCanvasAsImage,\r\n  }));\r\n\r\n  useEffect(() => {\r\n    const canvas = canvasRef.current;\r\n    const ctx = canvas.getContext('2d');\r\n\r\n    const clothImage = new Image();\r\n    const patternImage = new Image();\r\n    clothImage.onload = () => {\r\n      const { width, height } = clothImage;\r\n      canvas.width = width;\r\n      canvas.height = height;\r\n      canvas.style.width = 'auto'; // ����canvas����Ϊ������50%���߶�����Ӧ���ֱ���\r\n      canvas.style.height = '100%';\r\n      canvas.style.objectFit = 'contain'; // ȷ��ͼ�񲻻ᱻ����\r\n      canvas.style.display = 'block'; // ʹcanvas���������о���\r\n      canvas.style.margin = 'auto';\r\n      ctx.drawImage(clothImage, 0, 0, canvas.width, canvas.height);\r\n      patternImage.onload = () => {\r\n        console.log(1)\r\n        const tempCanvas = document.createElement('canvas');\r\n        const tempCtx = tempCanvas.getContext('2d');\r\n        tempCanvas.width = canvas.width;\r\n        tempCanvas.height = canvas.height;\r\n\r\n        tempCtx.drawImage(patternImage, 0, 0, tempCanvas.width, tempCanvas.height);\r\n\r\n        tempCtx.globalCompositeOperation = 'destination-in';\r\n        tempCtx.drawImage(clothImage, 0, 0, tempCanvas.width, tempCanvas.height);\r\n\r\n        ctx.globalCompositeOperation = 'multiply';\r\n        ctx.drawImage(tempCanvas, 0, 0);\r\n\r\n        ctx.globalCompositeOperation = 'source-over';\r\n\r\n      };\r\n\r\n      patternImage.src = patternDataURL;\r\n    };\r\n\r\n    clothImage.src = 'cloth-removebg-preview.png'; // ���滻Ϊʵ�ʵ��·�ͼ��·��\r\n\r\n  }, [debounce,patternDataURL,spacing,sketchDataURL]);\r\n\r\n  return <canvas ref={canvasRef} ></canvas>;\r\n});\r\n\r\nexport default ClothBox;\r\n"],"mappings":";;AAAA,OAAOA,KAAK,IAAGC,UAAU,EAAEC,WAAW,EAAEC,SAAS,EAAEC,mBAAmB,EAAEC,MAAM,QAAO,OAAO;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAE7F,MAAMC,QAAQ,gBAAAC,EAAA,eAAGR,UAAU,CAAAS,EAAA,GAAAD,EAAA,CAAC,CAAC;EAAEE,aAAa;EAAEC,cAAc;EAACC,QAAQ;EAACC;AAAQ,CAAC,EAAEC,GAAG,KAAK;EAAAN,EAAA;EACvF,MAAMO,SAAS,GAAGX,MAAM,CAAC,IAAI,CAAC;EAE9B,MAAMY,iBAAiB,GAAGf,WAAW,CAAC,MAAM;IAC1C,MAAMgB,MAAM,GAAGF,SAAS,CAACG,OAAO;IAChC,IAAID,MAAM,EAAE;MACV,MAAME,SAAS,GAAGR,cAAc;MAChC,MAAMS,IAAI,GAAGC,QAAQ,CAACC,aAAa,CAAC,GAAG,CAAC;MACxCF,IAAI,CAACG,IAAI,GAAGJ,SAAS;MACrBC,IAAI,CAACI,QAAQ,GAAG,kBAAkB;MAClCH,QAAQ,CAACI,IAAI,CAACC,WAAW,CAACN,IAAI,CAAC;MAC/BA,IAAI,CAACO,KAAK,CAAC,CAAC;MACZN,QAAQ,CAACI,IAAI,CAACG,WAAW,CAACR,IAAI,CAAC;IACjC;EACF,CAAC,EAAE,CAACT,cAAc,CAAC,CAAC;;EAEpB;EACA,MAAMkB,QAAQ,GAAG5B,WAAW,CAAC,CAAC6B,IAAI,EAAEC,IAAI,KAAK;IAC3C,IAAIC,OAAO;IACX,OAAO,CAAC,GAAGC,IAAI,KAAK;MAClBC,YAAY,CAACF,OAAO,CAAC;MACrBA,OAAO,GAAGG,UAAU,CAAC,MAAM;QACzBL,IAAI,CAACM,KAAK,CAAC,IAAI,EAAEH,IAAI,CAAC;MACxB,CAAC,EAAEF,IAAI,CAAC;IACV,CAAC;EACH,CAAC,EAAE,EAAE,CAAC;EAEN5B,mBAAmB,CAACW,GAAG,EAAE,OAAO;IAC9BE;EACF,CAAC,CAAC,CAAC;EAEHd,SAAS,CAAC,MAAM;IACd,MAAMe,MAAM,GAAGF,SAAS,CAACG,OAAO;IAChC,MAAMmB,GAAG,GAAGpB,MAAM,CAACqB,UAAU,CAAC,IAAI,CAAC;IAEnC,MAAMC,UAAU,GAAG,IAAIC,KAAK,CAAC,CAAC;IAC9B,MAAMC,YAAY,GAAG,IAAID,KAAK,CAAC,CAAC;IAChCD,UAAU,CAACG,MAAM,GAAG,MAAM;MACxB,MAAM;QAAEC,KAAK;QAAEC;MAAO,CAAC,GAAGL,UAAU;MACpCtB,MAAM,CAAC0B,KAAK,GAAGA,KAAK;MACpB1B,MAAM,CAAC2B,MAAM,GAAGA,MAAM;MACtB3B,MAAM,CAAC4B,KAAK,CAACF,KAAK,GAAG,MAAM,CAAC,CAAC;MAC7B1B,MAAM,CAAC4B,KAAK,CAACD,MAAM,GAAG,MAAM;MAC5B3B,MAAM,CAAC4B,KAAK,CAACC,SAAS,GAAG,SAAS,CAAC,CAAC;MACpC7B,MAAM,CAAC4B,KAAK,CAACE,OAAO,GAAG,OAAO,CAAC,CAAC;MAChC9B,MAAM,CAAC4B,KAAK,CAACG,MAAM,GAAG,MAAM;MAC5BX,GAAG,CAACY,SAAS,CAACV,UAAU,EAAE,CAAC,EAAE,CAAC,EAAEtB,MAAM,CAAC0B,KAAK,EAAE1B,MAAM,CAAC2B,MAAM,CAAC;MAC5DH,YAAY,CAACC,MAAM,GAAG,MAAM;QAC1BQ,OAAO,CAACC,GAAG,CAAC,CAAC,CAAC;QACd,MAAMC,UAAU,GAAG/B,QAAQ,CAACC,aAAa,CAAC,QAAQ,CAAC;QACnD,MAAM+B,OAAO,GAAGD,UAAU,CAACd,UAAU,CAAC,IAAI,CAAC;QAC3Cc,UAAU,CAACT,KAAK,GAAG1B,MAAM,CAAC0B,KAAK;QAC/BS,UAAU,CAACR,MAAM,GAAG3B,MAAM,CAAC2B,MAAM;QAEjCS,OAAO,CAACJ,SAAS,CAACR,YAAY,EAAE,CAAC,EAAE,CAAC,EAAEW,UAAU,CAACT,KAAK,EAAES,UAAU,CAACR,MAAM,CAAC;QAE1ES,OAAO,CAACC,wBAAwB,GAAG,gBAAgB;QACnDD,OAAO,CAACJ,SAAS,CAACV,UAAU,EAAE,CAAC,EAAE,CAAC,EAAEa,UAAU,CAACT,KAAK,EAAES,UAAU,CAACR,MAAM,CAAC;QAExEP,GAAG,CAACiB,wBAAwB,GAAG,UAAU;QACzCjB,GAAG,CAACY,SAAS,CAACG,UAAU,EAAE,CAAC,EAAE,CAAC,CAAC;QAE/Bf,GAAG,CAACiB,wBAAwB,GAAG,aAAa;MAE9C,CAAC;MAEDb,YAAY,CAACc,GAAG,GAAG5C,cAAc;IACnC,CAAC;IAED4B,UAAU,CAACgB,GAAG,GAAG,4BAA4B,CAAC,CAAC;EAEjD,CAAC,EAAE,CAAC1B,QAAQ,EAAClB,cAAc,EAACE,OAAO,EAACH,aAAa,CAAC,CAAC;EAEnD,oBAAOJ,OAAA;IAAQQ,GAAG,EAAEC;EAAU;IAAAyC,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OAAU,CAAC;AAC3C,CAAC,kCAAC;AAACC,GAAA,GA1EGrD,QAAQ;AA4Ed,eAAeA,QAAQ;AAAC,IAAAE,EAAA,EAAAmD,GAAA;AAAAC,YAAA,CAAApD,EAAA;AAAAoD,YAAA,CAAAD,GAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}