{"ast":null,"code":"var _jsxFileName = \"F:\\\\\\u540C\\u6D4E\\u5B9E\\u4E60\\\\cutting\\\\src\\\\components\\\\SketchBox\\\\remake.js\",\n  _s = $RefreshSig$();\nimport React, { useRef, useEffect, useState } from 'react';\nimport { fabric } from 'fabric';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst Remake = () => {\n  _s();\n  const canvasRef = useRef(null);\n  const canvasSize = {\n    width: 512,\n    height: 512\n  };\n  const [fabricImages, setFabricImages] = useState([]);\n  useEffect(() => {\n    const canvas = new fabric.Canvas(canvasRef.current, {\n      width: canvasSize.width,\n      height: canvasSize.height,\n      backgroundColor: 'white'\n    });\n\n    // 设置画布的缩放和拖拽功能\n    canvas.setZoom(1);\n    canvas.setViewportTransform([1, 0, 0, 1, 0, 0]);\n    canvas.selection = true; // 允许选择对象\n\n    // 处理拖放事件\n    const handleDrop = event => {\n      event.preventDefault();\n      const files = event.dataTransfer.files;\n      for (let i = 0; i < files.length; i++) {\n        if (files[i].type.startsWith('image/')) {\n          const reader = new FileReader();\n          reader.onload = e => {\n            fabric.Image.fromURL(e.target.result, img => {\n              img.scaleToWidth(canvasSize.width / 3);\n              canvas.add(img);\n              setFabricImages(prevImages => [...prevImages, img]);\n            });\n          };\n          reader.readAsDataURL(files[i]);\n        }\n      }\n    };\n\n    // 允许拖放\n    const handleDragOver = event => {\n      event.preventDefault();\n    };\n\n    // 添加事件监听器\n    canvasRef.current.addEventListener('drop', handleDrop);\n    canvasRef.current.addEventListener('dragover', handleDragOver);\n\n    // 清理副作用\n    return () => {\n      canvasRef.current.removeEventListener('drop', handleDrop);\n      canvasRef.current.removeEventListener('dragover', handleDragOver);\n    };\n  }, []);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      display: 'flex',\n      justifyContent: 'center',\n      alignItems: 'center',\n      overflow: 'hidden',\n      height: '60vh',\n      width: '80vh',\n      // 设置宽度为80vh\n      position: 'relative'\n    },\n    children: /*#__PURE__*/_jsxDEV(\"canvas\", {\n      ref: canvasRef,\n      style: {\n        border: '1px solid black'\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 68,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 57,\n    columnNumber: 9\n  }, this);\n};\n_s(Remake, \"HuBHhXwGortEhLW9a36FuRZfvzw=\");\n_c = Remake;\nexport default Remake;\nvar _c;\n$RefreshReg$(_c, \"Remake\");","map":{"version":3,"names":["React","useRef","useEffect","useState","fabric","jsxDEV","_jsxDEV","Remake","_s","canvasRef","canvasSize","width","height","fabricImages","setFabricImages","canvas","Canvas","current","backgroundColor","setZoom","setViewportTransform","selection","handleDrop","event","preventDefault","files","dataTransfer","i","length","type","startsWith","reader","FileReader","onload","e","Image","fromURL","target","result","img","scaleToWidth","add","prevImages","readAsDataURL","handleDragOver","addEventListener","removeEventListener","style","display","justifyContent","alignItems","overflow","position","children","ref","border","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["F:/同济实习/cutting/src/components/SketchBox/remake.js"],"sourcesContent":["import React, { useRef, useEffect, useState } from 'react';\r\nimport { fabric } from 'fabric';\r\n\r\nconst Remake = () => {\r\n    const canvasRef = useRef(null);\r\n    const canvasSize = { width: 512, height: 512 };\r\n    const [fabricImages, setFabricImages] = useState([]);\r\n\r\n    useEffect(() => {\r\n        const canvas = new fabric.Canvas(canvasRef.current, {\r\n            width: canvasSize.width,\r\n            height: canvasSize.height,\r\n            backgroundColor: 'white',\r\n        });\r\n\r\n        // 设置画布的缩放和拖拽功能\r\n        canvas.setZoom(1);\r\n        canvas.setViewportTransform([1, 0, 0, 1, 0, 0]);\r\n        canvas.selection = true; // 允许选择对象\r\n\r\n        // 处理拖放事件\r\n        const handleDrop = (event) => {\r\n            event.preventDefault();\r\n            const files = event.dataTransfer.files;\r\n            for (let i = 0; i < files.length; i++) {\r\n                if (files[i].type.startsWith('image/')) {\r\n                    const reader = new FileReader();\r\n                    reader.onload = (e) => {\r\n                        fabric.Image.fromURL(e.target.result, (img) => {\r\n                            img.scaleToWidth(canvasSize.width / 3);\r\n                            canvas.add(img);\r\n                            setFabricImages(prevImages => [...prevImages, img]);\r\n                        });\r\n                    };\r\n                    reader.readAsDataURL(files[i]);\r\n                }\r\n            }\r\n        };\r\n\r\n        // 允许拖放\r\n        const handleDragOver = (event) => {\r\n            event.preventDefault();\r\n        };\r\n\r\n        // 添加事件监听器\r\n        canvasRef.current.addEventListener('drop', handleDrop);\r\n        canvasRef.current.addEventListener('dragover', handleDragOver);\r\n\r\n        // 清理副作用\r\n        return () => {\r\n            canvasRef.current.removeEventListener('drop', handleDrop);\r\n            canvasRef.current.removeEventListener('dragover', handleDragOver);\r\n        };\r\n    }, []);\r\n\r\n    return (\r\n        <div\r\n            style={{\r\n                display: 'flex',\r\n                justifyContent: 'center',\r\n                alignItems: 'center',\r\n                overflow: 'hidden',\r\n                height: '60vh',\r\n                width: '80vh', // 设置宽度为80vh\r\n                position: 'relative',\r\n            }}\r\n        >\r\n            <canvas\r\n                ref={canvasRef}\r\n                style={{ border: '1px solid black' }}\r\n            />\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default Remake;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}