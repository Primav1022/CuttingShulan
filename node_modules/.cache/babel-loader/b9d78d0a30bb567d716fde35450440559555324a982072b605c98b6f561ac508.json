{"ast":null,"code":"var _jsxFileName = \"F:\\\\\\u540C\\u6D4E\\u5B9E\\u4E60\\\\cutting\\\\src\\\\components\\\\SketchBox\\\\remake.js\",\n  _s = $RefreshSig$();\nimport React, { useRef, useEffect } from 'react';\nimport { fabric } from 'fabric';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst Remake = () => {\n  _s();\n  const canvasRef = useRef(null);\n  const canvasSize = {\n    width: 512,\n    height: 512\n  };\n  useEffect(() => {\n    let canvas;\n    const initCanvas = () => {\n      canvas = new fabric.Canvas(canvasRef.current, {\n        width: canvasSize.width,\n        height: canvasSize.height,\n        backgroundColor: 'white'\n      });\n\n      // 设置画布的缩放和拖拽功能\n      canvas.setZoom(1);\n      canvas.setViewportTransform([1, 0, 0, 1, 0, 0]);\n      canvas.selection = true;\n\n      // 添加拖放事件监听器\n      canvasRef.current.addEventListener('drop', handleDrop);\n      canvasRef.current.addEventListener('dragover', handleDragOver);\n    };\n    const handleDrop = event => {\n      event.preventDefault();\n      const files = event.dataTransfer.files;\n      for (let i = 0; i < files.length; i++) {\n        if (files[i].type.startsWith('image/')) {\n          const reader = new FileReader();\n          reader.onload = e => {\n            const imgElement = new Image();\n            imgElement.onload = () => {\n              const imgInstance = new fabric.Image(imgElement, {\n                left: 0,\n                top: 0,\n                angle: 0,\n                scaleX: 0.1,\n                scaleY: 0.1\n              });\n              canvas.add(imgInstance);\n              canvas.setActiveObject(imgInstance);\n              canvas.requestRenderAll();\n            };\n            imgElement.src = e.target.result;\n          };\n          reader.readAsDataURL(files[i]);\n        }\n      }\n    };\n    const handleDragOver = event => {\n      event.preventDefault();\n    };\n    initCanvas();\n    return () => {\n      if (canvas) {\n        canvas.dispose();\n      }\n      canvasRef.current.removeEventListener('drop', handleDrop);\n      canvasRef.current.removeEventListener('dragover', handleDragOver);\n    };\n  }, []);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      display: 'flex',\n      justifyContent: 'center',\n      alignItems: 'center',\n      overflow: 'hidden',\n      height: '60vh',\n      position: 'relative'\n    },\n    children: /*#__PURE__*/_jsxDEV(\"canvas\", {\n      ref: canvasRef,\n      style: {\n        border: '1px solid black'\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 71,\n    columnNumber: 9\n  }, this);\n};\n_s(Remake, \"UJgi7ynoup7eqypjnwyX/s32POg=\");\n_c = Remake;\nexport default Remake;\nvar _c;\n$RefreshReg$(_c, \"Remake\");","map":{"version":3,"names":["React","useRef","useEffect","fabric","jsxDEV","_jsxDEV","Remake","_s","canvasRef","canvasSize","width","height","canvas","initCanvas","Canvas","current","backgroundColor","setZoom","setViewportTransform","selection","addEventListener","handleDrop","handleDragOver","event","preventDefault","files","dataTransfer","i","length","type","startsWith","reader","FileReader","onload","e","imgElement","Image","imgInstance","left","top","angle","scaleX","scaleY","add","setActiveObject","requestRenderAll","src","target","result","readAsDataURL","dispose","removeEventListener","style","display","justifyContent","alignItems","overflow","position","children","ref","border","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["F:/同济实习/cutting/src/components/SketchBox/remake.js"],"sourcesContent":["import React, { useRef, useEffect } from 'react';\r\nimport { fabric } from 'fabric';\r\n\r\nconst Remake = () => {\r\n    const canvasRef = useRef(null);\r\n    const canvasSize = { width: 512, height: 512 };\r\n\r\n    useEffect(() => {\r\n        let canvas;\r\n\r\n        const initCanvas = () => {\r\n            canvas = new fabric.Canvas(canvasRef.current, {\r\n                width: canvasSize.width,\r\n                height: canvasSize.height,\r\n                backgroundColor: 'white',\r\n            });\r\n\r\n            // 设置画布的缩放和拖拽功能\r\n            canvas.setZoom(1);\r\n            canvas.setViewportTransform([1, 0, 0, 1, 0, 0]);\r\n            canvas.selection = true;\r\n\r\n            // 添加拖放事件监听器\r\n            canvasRef.current.addEventListener('drop', handleDrop);\r\n            canvasRef.current.addEventListener('dragover', handleDragOver);\r\n        };\r\n\r\n        const handleDrop = (event) => {\r\n            event.preventDefault();\r\n            const files = event.dataTransfer.files;\r\n            for (let i = 0; i < files.length; i++) {\r\n                if (files[i].type.startsWith('image/')) {\r\n                    const reader = new FileReader();\r\n                    reader.onload = (e) => {\r\n                        const imgElement = new Image();\r\n                        imgElement.onload = () => {\r\n                            const imgInstance = new fabric.Image(imgElement, {\r\n                                left: 0,\r\n                                top: 0,\r\n                                angle: 0,\r\n                                scaleX: 0.1,\r\n                                scaleY: 0.1,\r\n                            });\r\n                            canvas.add(imgInstance);\r\n                            canvas.setActiveObject(imgInstance);\r\n                            canvas.requestRenderAll();\r\n                        };\r\n                        imgElement.src = e.target.result;\r\n                    };\r\n                    reader.readAsDataURL(files[i]);\r\n                }\r\n            }\r\n        };\r\n\r\n        const handleDragOver = (event) => {\r\n            event.preventDefault();\r\n        };\r\n\r\n        initCanvas();\r\n\r\n        return () => {\r\n            if (canvas) {\r\n                canvas.dispose();\r\n            }\r\n            canvasRef.current.removeEventListener('drop', handleDrop);\r\n            canvasRef.current.removeEventListener('dragover', handleDragOver);\r\n        };\r\n    }, []);\r\n\r\n    return (\r\n        <div\r\n            style={{\r\n                display: 'flex',\r\n                justifyContent: 'center',\r\n                alignItems: 'center',\r\n                overflow: 'hidden',\r\n                height: '60vh',\r\n                position: 'relative',\r\n            }}\r\n        >\r\n            <canvas\r\n                ref={canvasRef}\r\n                style={{ border: '1px solid black' }}\r\n            />\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default Remake;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}