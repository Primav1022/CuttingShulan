{"ast":null,"code":"// App.js\nimport React,{useState,useRef,useCallback,useEffect}from'react';import'./App.css';import GenerationImg from'./containers/GenerationImg/GenerationImg';import Makeunit from'./containers/Makeunit/Makeunit';import MakeContionous from'./containers/MakeContinuous/MakeContinuous';import ShowClothes from'./containers/ShowClothes/ShowClothes';import localForage from\"localforage\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function App(){useEffect(()=>{// 检查并清理存储的数据\nconst keysToClear=['generatedImages'];// 列出所有你想清理的key\nkeysToClear.forEach(key=>{localForage.getItem(key).then(value=>{if(value!==null){console.log(\"Clearing data for key: \".concat(key));localForage.removeItem(key).then(()=>{console.log(\"Data cleared for key: \".concat(key));}).catch(err=>{console.error(\"Error clearing data for key: \".concat(key),err);});}});});},[]);const[spacing,setSpacing]=useState(10);// 初始间距\nconst[imgscale,setImgscale]=useState(1);// 初始倍数\nconst[fileCounter,setFileCounter]=useState(1);// 用于生成文件名的自增计数器\n// 增加间距\nconst[selectedColor,setSelectedColor]=useState('#FFFFFF');// 默认为白色\nconst[savedPatternDataURL,setSavedPatternDataURL]=useState(null);const makeContinuousRef=useRef(null);const handlePatternSave=useCallback(dataURL=>{setSavedPatternDataURL(dataURL);},[]);const[selectedMaterials,setSelectedMaterials]=useState([]);const[sketchDataURL,setSketchDataURL]=useState(null);const handleAddMaterial=newMaterial=>{setSelectedMaterials(prevMaterials=>[...prevMaterials,newMaterial]);};const[currentStep,setCurrentStep]=useState(1);const handleNextStep=()=>{setCurrentStep(currentStep<4?currentStep+1:4);};const handlePrevStep=()=>{setCurrentStep(currentStep>1?currentStep-1:1);};const handleSaveSketch=dataURL=>{setSketchDataURL(dataURL);};const[connectionType,setConnectionType]=useState('平接');return/*#__PURE__*/_jsxs(\"div\",{className:\"content\",children:[currentStep===1&&/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(GenerationImg,{currentStep:currentStep,handleNextStep:handleNextStep,handlePrevStep:handlePrevStep,selectedMaterials:selectedMaterials,onAddMaterial:handleAddMaterial})}),currentStep===2&&/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(Makeunit,{currentStep:currentStep,handleNextStep:handleNextStep,handlePrevStep:handlePrevStep,selectedMaterials:selectedMaterials,onAddMaterial:handleAddMaterial,onSaveSketch:handleSaveSketch})}),currentStep===3&&/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(MakeContionous,{imgscale:imgscale,setImgscale:setImgscale,connectionType:connectionType,setConnectionType:setConnectionType,spacing:spacing,selectedColor:selectedColor,setSelectedColor:setSelectedColor,setSpacing:setSpacing,ref:makeContinuousRef,currentStep:currentStep,handleNextStep:handleNextStep,handlePrevStep:handlePrevStep,onSaveSketch:handleSaveSketch,sketchDataURL:sketchDataURL,onSave:handlePatternSave})}),currentStep===4&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(ShowClothes,{fileCounter:fileCounter,setFileCounter:setFileCounter,selectedColor:selectedColor,imgscale:imgscale,setImgscale:setImgscale,spacing:spacing,setSpacing:setSpacing,patternDataURL:savedPatternDataURL,currentStep:currentStep,handleNextStep:handleNextStep,handlePrevStep:handlePrevStep,sketchDataURL:sketchDataURL}),/*#__PURE__*/_jsx(MakeContionous,{imgscale:imgscale,setImgscale:setImgscale,connectionType:connectionType,patternDataURL:savedPatternDataURL,setConnectionType:setConnectionType,selectedColor:selectedColor,spacing:spacing,setSpacing:setSpacing,ref:makeContinuousRef,currentStep:currentStep,handleNextStep:handleNextStep,handlePrevStep:handlePrevStep,onSaveSketch:handleSaveSketch,sketchDataURL:sketchDataURL,onSave:handlePatternSave,style:{visibility:'hidden',position:'absolute',left:'-9999px'// 将组件移至屏幕外，确保不占用布局空间\n}})]})]});}export default App;","map":{"version":3,"names":["React","useState","useRef","useCallback","useEffect","GenerationImg","Makeunit","MakeContionous","ShowClothes","localForage","jsx","_jsx","jsxs","_jsxs","App","keysToClear","forEach","key","getItem","then","value","console","log","concat","removeItem","catch","err","error","spacing","setSpacing","imgscale","setImgscale","fileCounter","setFileCounter","selectedColor","setSelectedColor","savedPatternDataURL","setSavedPatternDataURL","makeContinuousRef","handlePatternSave","dataURL","selectedMaterials","setSelectedMaterials","sketchDataURL","setSketchDataURL","handleAddMaterial","newMaterial","prevMaterials","currentStep","setCurrentStep","handleNextStep","handlePrevStep","handleSaveSketch","connectionType","setConnectionType","className","children","onAddMaterial","onSaveSketch","ref","onSave","patternDataURL","style","visibility","position","left"],"sources":["F:/同济实习/cutting/src/App.js"],"sourcesContent":["// App.js\r\nimport React, {useState, useRef, useCallback, useEffect} from 'react';\r\nimport './App.css';\r\n\r\nimport GenerationImg from './containers/GenerationImg/GenerationImg';\r\nimport Makeunit from './containers/Makeunit/Makeunit';\r\nimport MakeContionous from './containers/MakeContinuous/MakeContinuous';\r\nimport ShowClothes from './containers/ShowClothes/ShowClothes';\r\nimport localForage from \"localforage\";\r\n\r\n\r\n\r\nfunction App() {\r\n  useEffect(() => {\r\n    // 检查并清理存储的数据\r\n    const keysToClear = ['generatedImages']; // 列出所有你想清理的key\r\n    keysToClear.forEach(key => {\r\n      localForage.getItem(key).then(value => {\r\n        if (value !== null) {\r\n          console.log(`Clearing data for key: ${key}`);\r\n          localForage.removeItem(key).then(() => {\r\n            console.log(`Data cleared for key: ${key}`);\r\n          }).catch(err => {\r\n            console.error(`Error clearing data for key: ${key}`, err);\r\n          });\r\n        }\r\n      });\r\n    });\r\n  }, []);\r\n  const [spacing, setSpacing] = useState(10); // 初始间距\r\n  const [imgscale, setImgscale] = useState(1); // 初始倍数\r\n  const [fileCounter, setFileCounter] = useState(1); // 用于生成文件名的自增计数器\r\n// 增加间距\r\n  const [selectedColor, setSelectedColor] = useState('#FFFFFF'); // 默认为白色\r\n  const [savedPatternDataURL, setSavedPatternDataURL] = useState(null);\r\n\r\n  const makeContinuousRef=useRef(null);\r\n \r\n    const handlePatternSave = useCallback((dataURL) => {\r\n        setSavedPatternDataURL(dataURL);\r\n    }, []);\r\n\r\n\r\n  const [selectedMaterials, setSelectedMaterials] = useState([]);\r\n  const [sketchDataURL, setSketchDataURL] = useState(null); \r\n  const handleAddMaterial = (newMaterial) => {\r\n    setSelectedMaterials(prevMaterials => [...prevMaterials, newMaterial]);\r\n  };\r\n  const [currentStep, setCurrentStep] = useState(1);\r\n\r\n  const handleNextStep = () => {\r\n    setCurrentStep(currentStep < 4 ? currentStep + 1 : 4);\r\n  };\r\n\r\n  const handlePrevStep = () => {\r\n    setCurrentStep(currentStep > 1 ? currentStep - 1 : 1);\r\n};\r\n\r\n  const handleSaveSketch = (dataURL) => {\r\n    setSketchDataURL(dataURL); \r\n  };\r\n  const [connectionType, setConnectionType] = useState('平接');\r\n\r\n  return (\r\n    <div className=\"content\">\r\n\r\n      {currentStep === 1 && <div>\r\n        <GenerationImg currentStep={currentStep} handleNextStep={handleNextStep} handlePrevStep={handlePrevStep} selectedMaterials={selectedMaterials} onAddMaterial={handleAddMaterial}/>\r\n\r\n        </div>}\r\n      {currentStep === 2 && <div>\r\n        <Makeunit currentStep={currentStep} handleNextStep={handleNextStep} handlePrevStep={handlePrevStep} selectedMaterials={selectedMaterials} onAddMaterial={handleAddMaterial}  onSaveSketch={handleSaveSketch}/>\r\n      </div>}\r\n      {currentStep === 3 && <div>\r\n        <MakeContionous imgscale={imgscale} setImgscale={setImgscale} connectionType={connectionType}  setConnectionType={setConnectionType} spacing={spacing} selectedColor={selectedColor}  setSelectedColor={setSelectedColor} setSpacing={setSpacing} ref={makeContinuousRef} currentStep={currentStep} handleNextStep={handleNextStep} handlePrevStep={handlePrevStep} onSaveSketch={handleSaveSketch} sketchDataURL={sketchDataURL} onSave={handlePatternSave}/>\r\n      </div>}\r\n      {currentStep === 4 && <div>\r\n        <ShowClothes fileCounter={fileCounter} setFileCounter={setFileCounter} selectedColor={selectedColor} imgscale={imgscale} setImgscale={setImgscale} spacing={spacing} setSpacing={setSpacing}  patternDataURL={savedPatternDataURL} currentStep={currentStep} handleNextStep={handleNextStep} handlePrevStep={handlePrevStep} sketchDataURL={sketchDataURL}/>\r\n        <MakeContionous  imgscale={imgscale} setImgscale={setImgscale} connectionType={connectionType} patternDataURL={savedPatternDataURL}  setConnectionType={setConnectionType} selectedColor={selectedColor} spacing={spacing} setSpacing={setSpacing} ref={makeContinuousRef} currentStep={currentStep} handleNextStep={handleNextStep} handlePrevStep={handlePrevStep} onSaveSketch={handleSaveSketch} sketchDataURL={sketchDataURL} onSave={handlePatternSave}\r\n                        style={{\r\n                          visibility: 'hidden',\r\n                          position: 'absolute',\r\n                          left: '-9999px', // 将组件移至屏幕外，确保不占用布局空间\r\n                        }}/>\r\n    </div>}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default App;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}