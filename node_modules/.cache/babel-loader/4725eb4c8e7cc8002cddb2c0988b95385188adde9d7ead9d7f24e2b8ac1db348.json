{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useState, useEffect } from 'react';\nimport localForage from 'localforage';\nexport function useIndexedDBStorage(key, initialValue) {\n  _s();\n  const [state, setState] = useState(initialValue);\n\n  // �� IndexedDB ��ȡ����\n  useEffect(() => {\n    localForage.getItem(key).then(storedValue => {\n      if (storedValue !== null) {\n        setState(storedValue);\n      }\n    });\n  }, [key]);\n\n  // ���� state �仯������ IndexedDB\n  useEffect(() => {\n    localForage.setItem(key, state);\n\n    // ������������������������ر��¼�\n    const handleUnload = () => {\n      localForage.removeItem(key);\n    };\n\n    // �����¼�������\n    window.addEventListener('unload', handleUnload);\n\n    // ����һ���������������������ж��ʱ�Ƴ��¼�������\n    return () => {\n      window.removeEventListener('unload', handleUnload);\n    };\n  }, [key, state]);\n  return [state, setState];\n}\n_s(useIndexedDBStorage, \"Dw7FzWEUx+DNQcrCcAKqC8pmA78=\");","map":{"version":3,"names":["useState","useEffect","localForage","useIndexedDBStorage","key","initialValue","_s","state","setState","getItem","then","storedValue","setItem","handleUnload","removeItem","window","addEventListener","removeEventListener"],"sources":["F:/同济实习/cutting/src/containers/GenerationImg/storage.js"],"sourcesContent":["import { useState, useEffect } from 'react';\r\nimport localForage from 'localforage';\r\n\r\nexport function useIndexedDBStorage(key, initialValue) {\r\n    const [state, setState] = useState(initialValue);\r\n\r\n    // �� IndexedDB ��ȡ����\r\n    useEffect(() => {\r\n        localForage.getItem(key).then(storedValue => {\r\n            if (storedValue !== null) {\r\n                setState(storedValue);\r\n            }\r\n        });\r\n    }, [key]);\r\n\r\n    // ���� state �仯������ IndexedDB\r\n    useEffect(() => {\r\n        localForage.setItem(key, state);\r\n\r\n        // ������������������������ر��¼�\r\n        const handleUnload = () => {\r\n            localForage.removeItem(key);\r\n        };\r\n\r\n        // �����¼�������\r\n        window.addEventListener('unload', handleUnload);\r\n\r\n        // ����һ���������������������ж��ʱ�Ƴ��¼�������\r\n        return () => {\r\n            window.removeEventListener('unload', handleUnload);\r\n        };\r\n    }, [key, state]);\r\n\r\n    return [state, setState];\r\n}\r\n"],"mappings":";AAAA,SAASA,QAAQ,EAAEC,SAAS,QAAQ,OAAO;AAC3C,OAAOC,WAAW,MAAM,aAAa;AAErC,OAAO,SAASC,mBAAmBA,CAACC,GAAG,EAAEC,YAAY,EAAE;EAAAC,EAAA;EACnD,MAAM,CAACC,KAAK,EAAEC,QAAQ,CAAC,GAAGR,QAAQ,CAACK,YAAY,CAAC;;EAEhD;EACAJ,SAAS,CAAC,MAAM;IACZC,WAAW,CAACO,OAAO,CAACL,GAAG,CAAC,CAACM,IAAI,CAACC,WAAW,IAAI;MACzC,IAAIA,WAAW,KAAK,IAAI,EAAE;QACtBH,QAAQ,CAACG,WAAW,CAAC;MACzB;IACJ,CAAC,CAAC;EACN,CAAC,EAAE,CAACP,GAAG,CAAC,CAAC;;EAET;EACAH,SAAS,CAAC,MAAM;IACZC,WAAW,CAACU,OAAO,CAACR,GAAG,EAAEG,KAAK,CAAC;;IAE/B;IACA,MAAMM,YAAY,GAAGA,CAAA,KAAM;MACvBX,WAAW,CAACY,UAAU,CAACV,GAAG,CAAC;IAC/B,CAAC;;IAED;IACAW,MAAM,CAACC,gBAAgB,CAAC,QAAQ,EAAEH,YAAY,CAAC;;IAE/C;IACA,OAAO,MAAM;MACTE,MAAM,CAACE,mBAAmB,CAAC,QAAQ,EAAEJ,YAAY,CAAC;IACtD,CAAC;EACL,CAAC,EAAE,CAACT,GAAG,EAAEG,KAAK,CAAC,CAAC;EAEhB,OAAO,CAACA,KAAK,EAAEC,QAAQ,CAAC;AAC5B;AAACF,EAAA,CA/BeH,mBAAmB"},"metadata":{},"sourceType":"module","externalDependencies":[]}