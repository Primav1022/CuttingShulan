{"ast":null,"code":"var _jsxFileName = \"F:\\\\\\u540C\\u6D4E\\u5B9E\\u4E60\\\\cutting\\\\src\\\\components\\\\SketchBox\\\\remake.js\",\n  _s = $RefreshSig$();\nimport React, { useRef, useEffect } from 'react';\nimport { fabric } from 'fabric';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst Remake = () => {\n  _s();\n  const canvasRef = useRef(null);\n  const canvasSize = {\n    width: 512,\n    height: 512\n  };\n  useEffect(() => {\n    const canvas = new fabric.Canvas(canvasRef.current, {\n      width: canvasSize.width,\n      height: canvasSize.height,\n      backgroundColor: 'white'\n    });\n\n    // 设置画布的缩放和拖拽功能\n    canvas.setZoom(1);\n    canvas.setViewportTransform([1, 0, 0, 1, 0, 0]);\n    canvas.selection = true; // 允许选择对象\n\n    // 处理拖放事件\n    const handleDrop = event => {\n      event.preventDefault();\n      const files = event.dataTransfer.files;\n      if (files.length > 0 && files[0].type.startsWith('image/')) {\n        const reader = new FileReader();\n        reader.onload = e => {\n          const img = new Image();\n          img.src = e.target.result;\n          img.onload = () => {\n            const fabricImage = new fabric.Image(img);\n            fabricImage.scaleToWidth(canvasSize.width / 3); // 调整图片大小为Canvas大小的三分之一\n            canvas.add(fabricImage);\n            canvas.setActiveObject(fabricImage);\n            canvas.requestRenderAll();\n          };\n        };\n        reader.readAsDataURL(files[0]);\n      }\n    };\n\n    // 允许拖放\n    const handleDragOver = event => {\n      event.preventDefault();\n    };\n\n    // 添加事件监听器\n    canvasRef.current.addEventListener('drop', handleDrop);\n    canvasRef.current.addEventListener('dragover', handleDragOver);\n\n    // 清理副作用\n    return () => {\n      canvasRef.current.removeEventListener('drop', handleDrop);\n      canvasRef.current.removeEventListener('dragover', handleDragOver);\n    };\n  }, []);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      display: 'flex',\n      justifyContent: 'center',\n      alignItems: 'center',\n      overflow: 'hidden',\n      height: '60vh',\n      width: '80vh',\n      // 设置宽度为80vh\n      position: 'relative'\n    },\n    children: /*#__PURE__*/_jsxDEV(\"canvas\", {\n      ref: canvasRef,\n      style: {\n        border: '1px solid black'\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 58,\n    columnNumber: 9\n  }, this);\n};\n_s(Remake, \"UJgi7ynoup7eqypjnwyX/s32POg=\");\n_c = Remake;\nexport default Remake;\nvar _c;\n$RefreshReg$(_c, \"Remake\");","map":{"version":3,"names":["React","useRef","useEffect","fabric","jsxDEV","_jsxDEV","Remake","_s","canvasRef","canvasSize","width","height","canvas","Canvas","current","backgroundColor","setZoom","setViewportTransform","selection","handleDrop","event","preventDefault","files","dataTransfer","length","type","startsWith","reader","FileReader","onload","e","img","Image","src","target","result","fabricImage","scaleToWidth","add","setActiveObject","requestRenderAll","readAsDataURL","handleDragOver","addEventListener","removeEventListener","style","display","justifyContent","alignItems","overflow","position","children","ref","border","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["F:/同济实习/cutting/src/components/SketchBox/remake.js"],"sourcesContent":["import React, { useRef, useEffect } from 'react';\r\nimport { fabric } from 'fabric';\r\n\r\nconst Remake = () => {\r\n    const canvasRef = useRef(null);\r\n    const canvasSize = { width: 512, height: 512 };\r\n\r\n    useEffect(() => {\r\n        const canvas = new fabric.Canvas(canvasRef.current, {\r\n            width: canvasSize.width,\r\n            height: canvasSize.height,\r\n            backgroundColor: 'white',\r\n        });\r\n\r\n        // 设置画布的缩放和拖拽功能\r\n        canvas.setZoom(1);\r\n        canvas.setViewportTransform([1, 0, 0, 1, 0, 0]);\r\n        canvas.selection = true; // 允许选择对象\r\n\r\n        // 处理拖放事件\r\n        const handleDrop = (event) => {\r\n            event.preventDefault();\r\n            const files = event.dataTransfer.files;\r\n            if (files.length > 0 && files[0].type.startsWith('image/')) {\r\n                const reader = new FileReader();\r\n                reader.onload = (e) => {\r\n                    const img = new Image();\r\n                    img.src = e.target.result;\r\n                    img.onload = () => {\r\n                        const fabricImage = new fabric.Image(img);\r\n                        fabricImage.scaleToWidth(canvasSize.width / 3); // 调整图片大小为Canvas大小的三分之一\r\n                        canvas.add(fabricImage);\r\n                        canvas.setActiveObject(fabricImage);\r\n                        canvas.requestRenderAll();\r\n                    };\r\n                };\r\n                reader.readAsDataURL(files[0]);\r\n            }\r\n        };\r\n\r\n        // 允许拖放\r\n        const handleDragOver = (event) => {\r\n            event.preventDefault();\r\n        };\r\n\r\n        // 添加事件监听器\r\n        canvasRef.current.addEventListener('drop', handleDrop);\r\n        canvasRef.current.addEventListener('dragover', handleDragOver);\r\n\r\n        // 清理副作用\r\n        return () => {\r\n            canvasRef.current.removeEventListener('drop', handleDrop);\r\n            canvasRef.current.removeEventListener('dragover', handleDragOver);\r\n        };\r\n    }, []);\r\n\r\n    return (\r\n        <div\r\n            style={{\r\n                display: 'flex',\r\n                justifyContent: 'center',\r\n                alignItems: 'center',\r\n                overflow: 'hidden',\r\n                height: '60vh',\r\n                width: '80vh', // 设置宽度为80vh\r\n                position: 'relative',\r\n            }}\r\n        >\r\n            <canvas\r\n                ref={canvasRef}\r\n                style={{ border: '1px solid black' }}\r\n            />\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default Remake;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}