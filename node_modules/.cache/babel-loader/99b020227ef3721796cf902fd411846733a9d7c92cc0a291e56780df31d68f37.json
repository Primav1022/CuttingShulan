{"ast":null,"code":"import React,{useState,useEffect,useRef}from'react';import Moveable from'react-moveable';import'./SketchBox.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const SketchBox=_ref=>{let{targets,setTargets}=_ref;const[lastTranslate,setLastTranslate]=useState([0,0]);const[selectedTarget,setSelectedTarget]=useState(null);const[moveableTarget,setMoveableTarget]=useState(null);const[isDragging,setIsDragging]=useState(false);const deleteButtonSize=30;const deleteButtonOffset=deleteButtonSize/2;const[deleteButtonPosition,setDeleteButtonPosition]=useState({x:0,y:0});const calculateRotatedTopRight=(x,y,width,height,rotate)=>{// �?心点坐标\nconst centerX=x+width/2;const centerY=y+height/2;// 右上角相对于�?心点的相对位\nconst relativeX=width/2;const relativeY=-height/2;// 将旋�?角度从度�?�?为弧�?\nconst radians=rotate*(Math.PI/180);// 应用旋转\nconst rotatedX=relativeX*Math.cos(radians)-relativeY*Math.sin(radians);const rotatedY=relativeX*Math.sin(radians)+relativeY*Math.cos(radians);// �?换回绝�?�坐�?\nconst absoluteX=centerX+rotatedX;const absoluteY=centerY+rotatedY;return{x:absoluteX,y:absoluteY};};// 使用该函数来获取旋转后右上�?�的坐标\nlet rotatedTopRight={x:0,y:0};if(selectedTarget){rotatedTopRight=calculateRotatedTopRight(selectedTarget.x,selectedTarget.y,selectedTarget.width,selectedTarget.height,selectedTarget.rotate);}// 现在你可以使�? rotatedTopRight.x �? rotatedTopRight.y 作为删除�?的坐�?\nconst onDrag=_ref2=>{let{target,beforeTranslate}=_ref2;const id=parseInt(target.parentElement.getAttribute('data-id'));const targetData=targets.find(t=>t.id===id);if(targetData){const deltaX=beforeTranslate[0]-lastTranslate[0];const deltaY=beforeTranslate[1]-lastTranslate[1];const radians=targetData.rotate*(Math.PI/180);const cos=Math.cos(radians);const sin=Math.sin(radians);const adjustedX=deltaX*cos-deltaY*sin;const adjustedY=deltaY*cos+deltaX*sin;// 计算新位�?，但尚未应用边界限制\nlet newX=targetData.x+adjustedX;let newY=targetData.y+adjustedY;// 使用 SketchBox �? 60vh 作为活动区域的垂直限�?\nconst maxHeight=window.innerHeight*0.6-targetData.height;const maxWidth=window.innerHeight*0.6-targetData.width;// 应用边界限制\nnewX=Math.max(0,Math.min(newX,maxWidth));newY=Math.max(0,Math.min(newY,maxHeight));// 更新�?标位�?\nupdateTarget(id,{x:newX,y:newY});setLastTranslate(beforeTranslate);// 更新 lastTranslate 为当前的 beforeTranslate\n}};const onRotate=_ref3=>{let{target,beforeRotate}=_ref3;const id=parseInt(target.parentElement.getAttribute('data-id'));const targetData=targets.find(t=>t.id===id);if(targetData){const newRotate=targetData.rotate+beforeRotate;updateTarget(id,{rotate:newRotate});}};useEffect(()=>{if(selectedTarget){setMoveableTarget(document.querySelector(\".img-container[data-id=\\\"\".concat(selectedTarget.id,\"\\\"] > img\")));}},[selectedTarget,targets]);const[containerSize,setContainerSize]=useState({width:0,height:0});const containerRef=useRef(null);useEffect(()=>{if(containerRef.current){setContainerSize({width:containerRef.current.offsetWidth,height:containerRef.current.offsetHeight});}},[containerRef.current]);function onDrop(event){event.preventDefault();const data=event.dataTransfer.getData('application/json');// �?保只有当有数�?时才尝试解析\nif(data){const{type,url}=JSON.parse(data);if(type==='library'){// 获取 SketchBox 容器的边�?\nconst boxRect=event.currentTarget.getBoundingClientRect();// 调整坐标，使其相对于 SketchBox 容器\nconst x=event.clientX-boxRect.left;const y=event.clientY-boxRect.top;// 创建新图�?\nconst newImage={id:Date.now(),src:url,x:x,y:y,width:100,height:100,rotate:0};setTargets([...targets,newImage]);}}}useEffect(()=>{if(selectedTarget){// 使用计算旋转后右上�?�坐标的函数\nconst{x,y}=calculateRotatedTopRight(selectedTarget.x,selectedTarget.y,selectedTarget.width,selectedTarget.height,selectedTarget.rotate);// 更新删除�?的位�?状�?\nsetDeleteButtonPosition({x,y});}},[selectedTarget]);const onDragOver=event=>{event.preventDefault();};const onDragStart=_ref4=>{let{target}=_ref4;setIsDragging(true);const id=parseInt(target.parentElement.getAttribute('data-id'));const targetData=targets.find(target=>target.id===id);if(targetData){setLastTranslate([0,0]);// 重置为初始�?\n}};const onDragEnd=_ref5=>{let{target}=_ref5;setIsDragging(false);};const deleteImage=id=>{setTargets(targets.filter(target=>target.id!==id));setSelectedTarget(null);setMoveableTarget(null);};const updateTarget=(id,updatedFields)=>{setTargets(targets.map(target=>target.id===id?{...target,...updatedFields}:target));};const handleSketchBoxClick=event=>{const isImageOrContainerClicked=event.target.closest('.img-container');if(!isImageOrContainerClicked){setSelectedTarget(null);setMoveableTarget(null);}};const onResize=_ref6=>{let{target,width,height}=_ref6;const id=parseInt(target.parentElement.getAttribute('data-id'));const targetData=targets.find(t=>t.id===id);if(targetData){// 确定新的宽度和高度，但不允许超过 SketchBox 的尺寸\nconst newWidth=Math.min(width,containerSize.width-targetData.x);const newHeight=Math.min(height,containerSize.height-targetData.y);// 更新目标尺寸\nupdateTarget(id,{width:newWidth,height:newHeight});}};return/*#__PURE__*/_jsxs(\"div\",{className:\"sketch-box\",ref:containerRef,onClick:handleSketchBoxClick,onDrop:onDrop,onDragOver:onDragOver,children:[targets.map(target=>{// 计算旋转后右上�?�的坐标，用于定位删除键\nconst{x,y}=calculateRotatedTopRight(target.x,target.y,target.width,target.height,target.rotate);return/*#__PURE__*/_jsxs(React.Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{\"data-id\":target.id,className:\"img-container\",style:{position:'absolute',left:target.x,top:target.y,transform:\"rotate(\".concat(target.rotate,\"deg)\"),width:\"\".concat(target.width,\"px\"),height:\"\".concat(target.height,\"px\")},children:/*#__PURE__*/_jsx(\"img\",{src:target.src,alt:\"Element \".concat(target.id),style:{width:'100%',height:'100%',cursor:'pointer'},onClick:()=>setSelectedTarget(target)})}),selectedTarget&&selectedTarget.id===target.id&&/*#__PURE__*/_jsx(\"div\",{onClick:()=>deleteImage(target.id),style:{position:'absolute',left:\"\".concat(x-deleteButtonOffset,\"px\"),// 调整以使圆心与右上顶点重�?\ntop:\"\".concat(y-deleteButtonOffset,\"px\"),// 调整以使圆心与右上顶点重�?\ncursor:'pointer',zIndex:100000000,// �?保删除按�?在图像上�?\nwidth:\"\".concat(deleteButtonSize,\"px\"),height:\"\".concat(deleteButtonSize,\"px\"),borderRadius:'50%',// 创建圆形按钮\nbackgroundColor:'red',display:'flex',alignItems:'center',justifyContent:'center'},children:/*#__PURE__*/_jsxs(\"svg\",{width:\"30\",height:\"30\",viewBox:\"0 0 30 30\",fill:\"none\",xmlns:\"http://www.w3.org/2000/svg\",children:[/*#__PURE__*/_jsx(\"circle\",{cx:\"15\",cy:\"15\",r:\"15\",fill:\"#333333\"}),/*#__PURE__*/_jsx(\"path\",{d:\"M10.7563 19.2422L19.2416 10.7569\",stroke:\"white\",strokeWidth:\"3\",strokeLinecap:\"round\"}),/*#__PURE__*/_jsx(\"path\",{d:\"M19.2437 19.2422L10.7584 10.7569\",stroke:\"white\",strokeWidth:\"3\",strokeLinecap:\"round\"})]})})]},target.id);}),/*#__PURE__*/_jsx(Moveable,{target:moveableTarget,draggable:true,resizable:true,rotatable:true,onDragStart:onDragStart,onDragEnd:onDragEnd,onDrag:onDrag,onResize:onResize,onRotate:onRotate})]});};export default SketchBox;","map":{"version":3,"names":["React","useState","useEffect","useRef","Moveable","jsx","_jsx","jsxs","_jsxs","SketchBox","_ref","targets","setTargets","lastTranslate","setLastTranslate","selectedTarget","setSelectedTarget","moveableTarget","setMoveableTarget","isDragging","setIsDragging","deleteButtonSize","deleteButtonOffset","deleteButtonPosition","setDeleteButtonPosition","x","y","calculateRotatedTopRight","width","height","rotate","centerX","centerY","relativeX","relativeY","radians","Math","PI","rotatedX","cos","sin","rotatedY","absoluteX","absoluteY","rotatedTopRight","onDrag","_ref2","target","beforeTranslate","id","parseInt","parentElement","getAttribute","targetData","find","t","deltaX","deltaY","adjustedX","adjustedY","newX","newY","maxHeight","window","innerHeight","maxWidth","max","min","updateTarget","onRotate","_ref3","beforeRotate","newRotate","document","querySelector","concat","containerSize","setContainerSize","containerRef","current","offsetWidth","offsetHeight","onDrop","event","preventDefault","data","dataTransfer","getData","type","url","JSON","parse","boxRect","currentTarget","getBoundingClientRect","clientX","left","clientY","top","newImage","Date","now","src","onDragOver","onDragStart","_ref4","onDragEnd","_ref5","deleteImage","filter","updatedFields","map","handleSketchBoxClick","isImageOrContainerClicked","closest","onResize","_ref6","newWidth","newHeight","className","ref","onClick","children","Fragment","style","position","transform","alt","cursor","zIndex","borderRadius","backgroundColor","display","alignItems","justifyContent","viewBox","fill","xmlns","cx","cy","r","d","stroke","strokeWidth","strokeLinecap","draggable","resizable","rotatable"],"sources":["F:/同济实习/cutting/src/components/SketchBox/SketchBox.js"],"sourcesContent":["import React, { useState, useEffect ,useRef} from 'react';\r\nimport Moveable from 'react-moveable';\r\n\r\nimport './SketchBox.css';\r\n\r\n\r\nconst SketchBox = ({ targets, setTargets }) => {\r\n  const [lastTranslate, setLastTranslate] = useState([0, 0]);\r\n  const [selectedTarget, setSelectedTarget] = useState(null);\r\n  const [moveableTarget, setMoveableTarget] = useState(null);\r\n  const [isDragging, setIsDragging] = useState(false);\r\n  const deleteButtonSize = 30;\r\n  const deleteButtonOffset = deleteButtonSize / 2;\r\n  const [deleteButtonPosition, setDeleteButtonPosition] = useState({ x: 0, y: 0 });\r\n\r\n  const calculateRotatedTopRight = (x, y, width, height, rotate) => {\r\n    // �?心点坐标\r\n    const centerX = x + width / 2;\r\n    const centerY = y + height / 2;\r\n  \r\n    // 右上角相对于�?心点的相对位\r\n    const relativeX = width / 2;\r\n    const relativeY = -height / 2;\r\n  \r\n    // 将旋�?角度从度�?�?为弧�?\r\n    const radians = rotate * (Math.PI / 180);\r\n  \r\n    // 应用旋转\r\n    const rotatedX = relativeX * Math.cos(radians) - relativeY * Math.sin(radians);\r\n    const rotatedY = relativeX * Math.sin(radians) + relativeY * Math.cos(radians);\r\n  \r\n    // �?换回绝�?�坐�?\r\n    const absoluteX = centerX + rotatedX;\r\n    const absoluteY = centerY + rotatedY;\r\n  \r\n    return { x: absoluteX, y: absoluteY };\r\n  };\r\n  \r\n  // 使用该函数来获取旋转后右上�?�的坐标\r\n  let rotatedTopRight = { x: 0, y: 0 };\r\n\r\nif (selectedTarget) {\r\n  rotatedTopRight = calculateRotatedTopRight(selectedTarget.x, selectedTarget.y, selectedTarget.width, selectedTarget.height, selectedTarget.rotate);\r\n}\r\n\r\n  \r\n  // 现在你可以使�? rotatedTopRight.x �? rotatedTopRight.y 作为删除�?的坐�?\r\n  \r\n  const onDrag = ({ target, beforeTranslate }) => {\r\n    const id = parseInt(target.parentElement.getAttribute('data-id'));\r\n    const targetData = targets.find(t => t.id === id);\r\n  \r\n    if (targetData) {\r\n      const deltaX = beforeTranslate[0] - lastTranslate[0];\r\n      const deltaY = beforeTranslate[1] - lastTranslate[1];\r\n  \r\n      const radians = targetData.rotate * (Math.PI / 180);\r\n      const cos = Math.cos(radians);\r\n      const sin = Math.sin(radians);\r\n  \r\n      const adjustedX = deltaX * cos - deltaY * sin;\r\n      const adjustedY = deltaY * cos + deltaX * sin;\r\n   // 计算新位�?，但尚未应用边界限制\r\n   let newX = targetData.x + adjustedX;\r\n   let newY = targetData.y + adjustedY;\r\n\r\n   // 使用 SketchBox �? 60vh 作为活动区域的垂直限�?\r\n   const maxHeight = window.innerHeight * 0.6-targetData.height;\r\n   const maxWidth = window.innerHeight * 0.6-targetData.width;\r\n\r\n   // 应用边界限制\r\n   newX = Math.max(0, Math.min(newX, maxWidth));\r\n    newY = Math.max(0, Math.min(newY,maxHeight));\r\n\r\n   // 更新�?标位�?\r\n   updateTarget(id, {\r\n     x: newX,\r\n     y: newY\r\n   });\r\n  \r\n      setLastTranslate(beforeTranslate); // 更新 lastTranslate 为当前的 beforeTranslate\r\n    }\r\n  };\r\n  \r\n  \r\n  const onRotate = ({ target, beforeRotate }) => {\r\n    const id = parseInt(target.parentElement.getAttribute('data-id'));\r\n    const targetData = targets.find(t => t.id === id);\r\n  \r\n    if (targetData) {\r\n     \r\n      const newRotate = targetData.rotate + beforeRotate;\r\n\r\n  \r\n      updateTarget(id, { rotate: newRotate });\r\n    }\r\n  };\r\n  \r\n  \r\n\r\n  useEffect(() => {\r\n    if (selectedTarget) {\r\n      setMoveableTarget(document.querySelector(`.img-container[data-id=\"${selectedTarget.id}\"] > img`));\r\n    }\r\n  },\r\n   [selectedTarget, targets]);\r\n   \r\n   const [containerSize, setContainerSize] = useState({ width: 0, height: 0 });\r\n   const containerRef = useRef(null);\r\n \r\n   useEffect(() => {\r\n     if (containerRef.current) {\r\n       setContainerSize({\r\n         width: containerRef.current.offsetWidth,\r\n         height: containerRef.current.offsetHeight,\r\n       });\r\n     }\r\n   }, [containerRef.current]);\r\n   function onDrop(event) {\r\n    event.preventDefault();\r\n    const data = event.dataTransfer.getData('application/json');\r\n  \r\n    // �?保只有当有数�?时才尝试解析\r\n    if (data) {\r\n      const { type, url } = JSON.parse(data);\r\n  \r\n      if (type === 'library') {\r\n        // 获取 SketchBox 容器的边�?\r\n        const boxRect = event.currentTarget.getBoundingClientRect();\r\n  \r\n        // 调整坐标，使其相对于 SketchBox 容器\r\n        const x = event.clientX - boxRect.left;\r\n        const y = event.clientY - boxRect.top;\r\n  \r\n        // 创建新图�?\r\n        const newImage = {\r\n          id: Date.now(),\r\n          src: url,\r\n          x: x,\r\n          y: y,\r\n          width: 100,\r\n          height: 100,\r\n          rotate: 0,\r\n        };\r\n        setTargets([...targets, newImage]);\r\n      }\r\n    }\r\n  }\r\n  \r\n  \r\n  useEffect(() => {\r\n    if (selectedTarget) {\r\n      // 使用计算旋转后右上�?�坐标的函数\r\n      const { x, y } = calculateRotatedTopRight(\r\n        selectedTarget.x,\r\n        selectedTarget.y,\r\n        selectedTarget.width,\r\n        selectedTarget.height,\r\n        selectedTarget.rotate\r\n      );\r\n  \r\n      // 更新删除�?的位�?状�?\r\n      setDeleteButtonPosition({ x, y });\r\n    }\r\n  }, [selectedTarget]);\r\n  \r\n  const onDragOver = (event) => {\r\n    event.preventDefault(); \r\n  };\r\n\r\n\r\n  const onDragStart = ({ target }) => {\r\n    setIsDragging(true); \r\n    const id = parseInt(target.parentElement.getAttribute('data-id'));\r\n    const targetData = targets.find(target => target.id === id);\r\n    if (targetData) {\r\n      setLastTranslate([0, 0]); // 重置为初始�?\r\n    }\r\n  };\r\n   const onDragEnd = ({ target }) => {\r\n    setIsDragging(false); \r\n  };\r\n  const deleteImage = (id) => {\r\n    setTargets(targets.filter(target => target.id !== id));\r\n    setSelectedTarget(null);\r\n    setMoveableTarget(null);\r\n\r\n  };\r\n\r\n\r\n  const updateTarget = (id, updatedFields) => {\r\n    setTargets(targets.map(target => target.id === id ? { ...target, ...updatedFields } : target));\r\n  };\r\n\r\n  const handleSketchBoxClick = (event) => {\r\n\r\n    const isImageOrContainerClicked = event.target.closest('.img-container');\r\n\r\n\r\n    if (!isImageOrContainerClicked) {\r\n      setSelectedTarget(null);\r\n      setMoveableTarget(null);\r\n    }\r\n  };\r\n  const onResize = ({ target, width, height }) => {\r\n    const id = parseInt(target.parentElement.getAttribute('data-id'));\r\n    const targetData = targets.find(t => t.id === id);\r\n  \r\n    if (targetData) {\r\n      // 确定新的宽度和高度，但不允许超过 SketchBox 的尺寸\r\n      const newWidth = Math.min(width, containerSize.width - targetData.x);\r\n      const newHeight = Math.min(height, containerSize.height - targetData.y);\r\n  \r\n      // 更新目标尺寸\r\n      updateTarget(id, { width: newWidth, height: newHeight });\r\n    }\r\n  };\r\n  \r\n  \r\n  return (\r\n    <div className=\"sketch-box\" ref={containerRef} onClick={handleSketchBoxClick} onDrop={onDrop} onDragOver={onDragOver}>\r\n      {targets.map((target) => {\r\n        // 计算旋转后右上�?�的坐标，用于定位删除键\r\n        const { x, y } = calculateRotatedTopRight(target.x, target.y, target.width, target.height, target.rotate);\r\n\r\n        return (\r\n          <React.Fragment key={target.id}>\r\n      <div\r\n        data-id={target.id}\r\n        className=\"img-container\"\r\n        style={{\r\n          position: 'absolute',\r\n          left: target.x,\r\n          top: target.y,\r\n          transform: `rotate(${target.rotate}deg)`,\r\n          width: `${target.width}px`,\r\n          height: `${target.height}px`\r\n        }}\r\n      >\r\n        <img\r\n          src={target.src}\r\n          alt={`Element ${target.id}`}\r\n          style={{ width: '100%', height: '100%', cursor: 'pointer' }}\r\n          onClick={() => setSelectedTarget(target)}\r\n        />\r\n      </div>\r\n      {selectedTarget && selectedTarget.id === target.id && (\r\n        <div\r\n          onClick={() => deleteImage(target.id)}\r\n          style={{\r\n            position: 'absolute',\r\n            left: `${x - deleteButtonOffset}px`, // 调整以使圆心与右上顶点重�?\r\n            top: `${y - deleteButtonOffset}px`, // 调整以使圆心与右上顶点重�?\r\n            cursor: 'pointer',\r\n            zIndex: 100000000, // �?保删除按�?在图像上�?\r\n            width: `${deleteButtonSize}px`,\r\n            height: `${deleteButtonSize}px`,\r\n            borderRadius: '50%', // 创建圆形按钮\r\n            backgroundColor: 'red',\r\n            display: 'flex',\r\n            alignItems: 'center',\r\n            justifyContent: 'center'\r\n          }}\r\n        >\r\n             <svg width=\"30\" height=\"30\" viewBox=\"0 0 30 30\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\r\n          <circle cx=\"15\" cy=\"15\" r=\"15\" fill=\"#333333\"/>\r\n          <path d=\"M10.7563 19.2422L19.2416 10.7569\" stroke=\"white\" strokeWidth=\"3\" strokeLinecap=\"round\"/>\r\n          <path d=\"M19.2437 19.2422L10.7584 10.7569\" stroke=\"white\" strokeWidth=\"3\" strokeLinecap=\"round\"/>\r\n        </svg>\r\n        </div>\r\n      )}\r\n    </React.Fragment>\r\n        );\r\n      })}\r\n        <Moveable\r\n          target={moveableTarget}\r\n          draggable={true}\r\n          resizable={true}\r\n          rotatable={true}\r\n          onDragStart={onDragStart}\r\n          onDragEnd={onDragEnd}\r\n          onDrag={onDrag}\r\n        onResize={onResize}\r\n          onRotate={onRotate}\r\n            \r\n        />\r\n    </div>\r\n  );\r\n        }\r\nexport default SketchBox;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}